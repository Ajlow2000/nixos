python
import sys
import os
import glob

# Try to find Rust GDB pretty printers in Nix store
rust_gdb_paths = [
    '/usr/share/gdb/python',  # Standard location
    '/nix/store/*/lib/rustlib/etc',  # Nix store location
]

# Find actual paths in Nix store
nix_rust_paths = glob.glob('/nix/store/*-rustc-*/lib/rustlib/etc')
rust_gdb_paths.extend(nix_rust_paths)

found_printers = False
for path in rust_gdb_paths:
    if os.path.exists(path):
        sys.path.insert(0, path)
        try:
            script_path = os.path.join(path, 'gdb_load_rust_pretty_printers.py')
            if os.path.exists(script_path):
                # Set __file__ for the script
                globals_dict = {'__file__': script_path}
                exec(open(script_path).read(), globals_dict)
                print(f"Loaded Rust GDB pretty printers from: {path}")
                found_printers = True
                break
        except (ImportError, FileNotFoundError, Exception) as e:
            print(f"Failed to load from {path}: {e}")
            continue

if not found_printers:
    print("Rust GDB pretty printers not found")
end

# Enable pretty printing
set print pretty on
set print array on
set print array-indexes on